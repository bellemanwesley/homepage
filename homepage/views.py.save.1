# coding=utf-8
from django.shortcuts import render
from django.http import HttpResponseRedirect
import requests
import sys
sys.path.insert(0, '/home/ec2-user/homepage/homepage/localviews/')
import ukrainian

def home(request):
	return HttpResponseRedirect('/get_content/?cname=home')

def get_content(request):
	cname = request.GET.get('cname',False)
	cname = cname.replace("_","/")
        data = requests.get('https://raw.githubusercontent.com/bellemanwesley/homepage/master/s3_files/'+cname+'_content.html')
	with open('/home/ec2-user/homepage/logs/prints.txt','a') as f:
		f.write(ukrainian.translate('привіт'))
        return(render(request,'home.html',{'data':data.text}))

def ukrainian_books(request):
        data = requests.get('https://raw.githubusercontent.com/bellemanwesley/homepage/master/s3_files/ukrainian/books_content.html')
        return(render(request,'home.html',{'data':data.text}))

def reader(request):
	with open('/home/ec2-user/files/Відьмак. Меч призначення.xml','r') as f:
		file_data = f.read()
	book_pages = ukrainian.return_pages(file_data,200)
	book_page = int(request.GET.get('page','0'))
	
        return(render(request,'reader.html',{'data':book_pages[book_j]}))

def post_data(request):
	password = request.POST.get('password','')
	with open('/home/ec2-user/keys/book_key.txt') as f:
		correct = f.readlines()[0]
	if password == correct:
		return HttpResponseRedirect('/ukrainian_books/')


